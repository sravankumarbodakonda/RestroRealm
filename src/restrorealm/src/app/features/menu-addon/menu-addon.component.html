<div class="addon-royal-container">
    <!-- Simple Elegant Header Section -->
    <header class="addon-simple-header">
        <div class="addon-header-left">
            <h1 class="addon-title">Menu Add-ons</h1>
        </div>
        
        <div class="addon-header-right">
            <div class="addon-search-container">
                <i class="fas fa-search addon-search-icon"></i>
                <input 
                    type="text" 
                    class="addon-search-field"
                    [(ngModel)]="searchTerm" 
                    (input)="onSearch()" 
                    placeholder="Search add-ons..."
                    aria-label="Search Add-ons"
                />
                <button *ngIf="searchTerm" class="addon-search-clear" (click)="clearSearch()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="addon-view-toggle">
                <button 
                    class="addon-view-btn" 
                    [class.addon-view-active]="viewMode === 'card'"
                    (click)="setViewMode('card')" 
                    aria-label="Card View">
                    <i class="fas fa-th-large"></i>
                </button>
                <button 
                    class="addon-view-btn" 
                    [class.addon-view-active]="viewMode === 'list'"
                    (click)="setViewMode('list')" 
                    aria-label="List View">
                    <i class="fas fa-list"></i>
                </button>
            </div>
            
            <button 
                *ngIf="createAddon"
                class="addon-create-btn" 
                (click)="openCreateDialog()">
                <i class="fas fa-plus"></i>
                <span>Add New</span>
            </button>
        </div>
    </header>

    <!-- No Permission Message -->
    <div *ngIf="!readAllAddons" class="addon-no-permission">
        <div class="addon-empty-illustration">
            <i class="fas fa-lock addon-empty-icon"></i>
        </div>
        <h3 class="addon-empty-title">Access Restricted</h3>
        <p class="addon-empty-message">You don't have permission to view menu add-ons. Please contact an administrator if you need access.</p>
    </div>

    <ng-container *ngIf="readAllAddons">
        <!-- Summary Panel -->
        <div class="addon-summary-panel">
            <div class="addon-summary-stat">
                <div class="addon-stat-value">{{menuAddons.length}}</div>
                <div class="addon-stat-label">Total Add-ons</div>
            </div>
            <div class="addon-summary-stat">
                <div class="addon-stat-value">{{getActiveAddons()}}</div>
                <div class="addon-stat-label">Active Add-ons</div>
            </div>
            <div class="addon-summary-stat">
                <div class="addon-stat-value">{{getInactiveAddons()}}</div>
                <div class="addon-stat-label">Inactive Add-ons</div>
            </div>
        </div>

        <!-- Main Content Area -->
        <main class="addon-content-area">
            <!-- Filter Bar -->
            <div class="addon-filter-bar">
                <div class="addon-filter-group">
                    <label class="addon-filter-label">Filter by:</label>
                    <div class="addon-filter-pills">
                        <button class="addon-filter-pill" [class.addon-filter-active]="currentFilter === 'all'" (click)="filterAddons('all')">All</button>
                        <button class="addon-filter-pill" [class.addon-filter-active]="currentFilter === 'active'" (click)="filterAddons('active')">Active</button>
                        <button class="addon-filter-pill" [class.addon-filter-active]="currentFilter === 'inactive'" (click)="filterAddons('inactive')">Inactive</button>
                        <button class="addon-filter-pill" (click)="filterByVegetarian(true)">Vegetarian</button>
                    </div>
                </div>
                <div class="addon-filter-group ml-4">
                    <label class="addon-filter-label">Spice Level:</label>
                    <select class="addon-filter-select" (change)="filterBySpiceLevel($event)">
                        <option value="">All Levels</option>
                        <option *ngFor="let option of spiceLevelOptions" [value]="option.value">{{option.label}}</option>
                    </select>
                </div>
                <div class="addon-sort-dropdown">
                    <label class="addon-sort-label">Sort by:</label>
                    <select class="addon-sort-select" (change)="sortAddons($event)">
                        <option value="name-asc">Name (A-Z)</option>
                        <option value="name-desc">Name (Z-A)</option>
                        <option value="price-low">Price (Low to High)</option>
                        <option value="price-high">Price (High to Low)</option>
                        <option value="newest">Newest First</option>
                        <option value="oldest">Oldest First</option>
                    </select>
                </div>
            </div>

            <!-- Loading Indicator -->
            <div *ngIf="loading" class="addon-loading">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Loading add-ons...</span>
            </div>

            <!-- Add-on Grid/List -->
            <div *ngIf="!loading" [class]="viewMode === 'card' ? 'addon-grid-container' : 'addon-list-container'">
                <!-- Card View -->
                <div *ngIf="viewMode === 'card'" class="addon-grid">
                    <article 
                        *ngFor="let addon of paginatedAddons"
                        class="addon-card"
                        [class.addon-inactive]="!addon.active">
                        
                        <div class="addon-card-media">
                            <img 
                                [src]="getImagePath(addon)" 
                                [alt]="addon.addOnName"
                                class="addon-card-image"
                                (error)="handleImageError($event)"
                                loading="lazy"
                            />
                            <div class="addon-card-overlay">
                                <div class="addon-card-badges">
                                    <span *ngIf="!addon.active" class="addon-badge addon-badge-inactive">
                                        <i class="fas fa-ban"></i> Inactive
                                    </span>
                                    <span *ngIf="addon.suggested" class="addon-badge addon-badge-suggested">
                                        <i class="fas fa-thumbs-up"></i> Suggested
                                    </span>
                                    <span *ngIf="addon.vegetarian" class="addon-badge addon-badge-vegetarian">
                                        <i class="fas fa-leaf"></i> Vegetarian
                                    </span>
                                    <span *ngIf="addon.spiceLevel && addon.spiceLevel !== 'NONE'" class="addon-badge addon-badge-spicy">
                                        <i class="fas fa-pepper-hot"></i> {{getSpiceLevelLabel(addon.spiceLevel)}}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="addon-card-content">
                            <div class="addon-card-price">${{formatPrice(addon.addOnPrice)}}</div>
                            <h2 class="addon-card-title">{{ addon.addOnName }}</h2>
                            <p class="addon-card-description">{{ addon.description || 'No description provided' }}</p>
                            
                            <div class="addon-card-categories" *ngIf="addon.categories && addon.categories.length > 0">
                                <div class="addon-category-chips">
                                    <span *ngFor="let category of addon.categories" class="addon-category-chip">
                                        {{category.name}}
                                    </span>
                                </div>
                            </div>
                            
                            <div class="addon-card-actions">
                                <button 
                                    *ngIf="readSingleAddon"
                                    class="addon-action-btn addon-view-btn-secondary"
                                    (click)="viewDetails(addon)"
                                    aria-label="View details">
                                    <i class="fas fa-eye"></i>
                                    <span class="addon-action-label">View</span>
                                </button>
                                <button 
                                    *ngIf="editAddon"
                                    class="addon-action-btn addon-edit-btn"
                                    (click)="openEditDialog(addon)"
                                    aria-label="Edit add-on">
                                    <i class="fas fa-edit"></i>
                                    <span class="addon-action-label">Edit</span>
                                </button>
                                <button 
                                    *ngIf="deleteSingleAddon"
                                    class="addon-action-btn addon-delete-btn"
                                    (click)="confirmDelete(addon)"
                                    aria-label="Delete add-on">
                                    <i class="fas fa-trash"></i>
                                    <span class="addon-action-label">Delete</span>
                                </button>
                            </div>
                        </div>
                    </article>
                </div>
                
                <!-- List View -->
                <div *ngIf="viewMode === 'list'" class="addon-list">
                    <div class="addon-list-header">
                        <div class="addon-list-cell addon-cell-image">Image</div>
                        <div class="addon-list-cell addon-cell-name">Name</div>
                        <div class="addon-list-cell addon-cell-description">Description</div>
                        <div class="addon-list-cell addon-cell-price">Price</div>
                        <div class="addon-list-cell addon-cell-status">Status</div>
                        <div class="addon-list-cell addon-cell-actions">Actions</div>
                    </div>
                    
                    <div 
                        *ngFor="let addon of paginatedAddons"
                        class="addon-list-row"
                        [class.addon-inactive]="!addon.active">
                        
                        <div class="addon-list-cell addon-cell-image">
                            <div class="addon-thumbnail-container">
                                <img 
                                    [src]="getImagePath(addon)" 
                                    [alt]="addon.addOnName"
                                    class="addon-thumbnail"
                                    (error)="handleImageError($event)"
                                />
                            </div>
                        </div>
                        
                        <div class="addon-list-cell addon-cell-name">
                            <h3 class="addon-list-title">{{ addon.addOnName }}</h3>
                            <div class="addon-list-badges">
                                <span *ngIf="addon.vegetarian" class="addon-list-badge addon-badge-vegetarian-small">Veg</span>
                                <span *ngIf="addon.spiceLevel && addon.spiceLevel !== 'NONE'" class="addon-list-badge addon-badge-spicy-small">{{addon.spiceLevel}}</span>
                            </div>
                        </div>
                        
                        <div class="addon-list-cell addon-cell-description">
                            <p class="addon-list-description">{{ addon.description || 'No description provided' }}</p>
                        </div>
                        
                        <div class="addon-list-cell addon-cell-price">
                            <div class="addon-price-display">
                                <span>${{formatPrice(addon.addOnPrice)}}</span>
                            </div>
                        </div>
                        
                        <div class="addon-list-cell addon-cell-status">
                            <div class="addon-status-container">
                                <span 
                                    class="addon-status-indicator" 
                                    [class.addon-status-active]="addon.active"
                                    [class.addon-status-inactive]="!addon.active">
                                </span>
                                <span class="addon-status-text">
                                    {{ addon.active ? 'Active' : 'Inactive' }}
                                </span>
                                <span *ngIf="addon.suggested" class="addon-suggested-indicator">
                                    <i class="fas fa-thumbs-up"></i>
                                </span>
                            </div>
                        </div>
                        
                        <div class="addon-list-cell addon-cell-actions">
                            <div class="addon-list-actions">
                                <button 
                                    *ngIf="readSingleAddon"
                                    class="addon-list-btn addon-view-btn-secondary"
                                    (click)="viewDetails(addon)"
                                    aria-label="View details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button 
                                    *ngIf="editAddon"
                                    class="addon-list-btn addon-edit-btn"
                                    (click)="openEditDialog(addon)"
                                    aria-label="Edit add-on">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button 
                                    *ngIf="deleteSingleAddon"
                                    class="addon-list-btn addon-delete-btn"
                                    (click)="confirmDelete(addon)"
                                    aria-label="Delete add-on">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Empty State -->
            <div *ngIf="!loading && filteredAddons.length === 0" class="addon-empty-state">
                <div class="addon-empty-illustration">
                    <i class="fas fa-utensils addon-empty-icon"></i>
                </div>
                <h3 class="addon-empty-title">No Add-ons Found</h3>
                <p class="addon-empty-message">Your search didn't match any add-ons in your collection</p>
                <button class="addon-empty-action" (click)="clearSearch()">Clear Search</button>
            </div>
            
            <!-- Pagination -->
            <div *ngIf="!loading && filteredAddons.length > 0" class="addon-pagination">
                <div class="addon-pagination-info">
                    Showing {{ (currentPage - 1) * pageSize + 1 }} to {{ Math.min(currentPage * pageSize, filteredAddons.length) }} of {{ filteredAddons.length }} add-ons
                </div>
                <div class="addon-pagination-controls">
                    <button 
                        class="addon-page-btn addon-prev-btn" 
                        [disabled]="currentPage === 1"
                        (click)="goToPage(currentPage - 1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    
                    <div class="addon-page-numbers">
                        <button 
                            *ngIf="currentPage > 2"
                            class="addon-page-number" 
                            (click)="goToPage(1)">
                            1
                        </button>
                        
                        <span *ngIf="currentPage > 3" class="addon-page-ellipsis">...</span>
                        
                        <button 
                            *ngIf="currentPage > 1"
                            class="addon-page-number" 
                            (click)="goToPage(currentPage - 1)">
                            {{ currentPage - 1 }}
                        </button>
                        
                        <button class="addon-page-number addon-page-current">
                            {{ currentPage }}
                        </button>
                        
                        <button 
                            *ngIf="currentPage < totalPages"
                            class="addon-page-number" 
                            (click)="goToPage(currentPage + 1)">
                            {{ currentPage + 1 }}
                        </button>
                        
                        <span *ngIf="currentPage < totalPages - 2" class="addon-page-ellipsis">...</span>
                        
                        <button 
                            *ngIf="currentPage < totalPages - 1"
                            class="addon-page-number" 
                            (click)="goToPage(totalPages)">
                            {{ totalPages }}
                        </button>
                    </div>
                    
                    <button 
                        class="addon-page-btn addon-next-btn"
                        [disabled]="currentPage === totalPages" 
                        (click)="goToPage(currentPage + 1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div class="addon-page-size">
                    <label for="pageSize" class="addon-page-size-label">Items per page:</label>
                    <select id="pageSize" class="addon-page-size-select" [(ngModel)]="pageSize" (change)="updatePageSize()">
                        <option value="6">6</option>
                        <option value="12">12</option>
                        <option value="24">24</option>
                        <option value="48">48</option>
                    </select>
                </div>
            </div>
        </main>
    </ng-container>

    <!-- Create/Edit Dialog -->
    <div class="addon-modal-backdrop" *ngIf="showDialog" (click)="closeDialogIfBackdrop($event)">
        <div class="addon-modal-container" (click)="$event.stopPropagation()">
            <div class="addon-modal-header">
                <h2 class="addon-modal-title">{{ editingAddon ? 'Edit Add-on' : 'Create New Add-on' }}</h2>
                <button class="addon-modal-close" (click)="closeDialog()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="addon-modal-divider"></div>
            
            <div class="addon-modal-body">
                <form [formGroup]="addonForm" (ngSubmit)="onSubmit()" class="addon-form">
                    <div class="addon-form-columns">
                        <div class="addon-form-left">
                            <div class="addon-form-group">
                                <label class="addon-form-label">Add-on Name <span class="addon-required">*</span></label>
                                <input 
                                    type="text" 
                                    formControlName="name"
                                    class="addon-form-input"
                                    [class.addon-input-error]="addonForm.get('name')?.invalid && addonForm.get('name')?.touched"
                                    placeholder="Enter add-on name"
                                />
                                <div *ngIf="addonForm.get('name')?.invalid && addonForm.get('name')?.touched" class="addon-error-message">
                                    <span *ngIf="addonForm.get('name')?.errors?.['required']">Name is required</span>
                                    <span *ngIf="addonForm.get('name')?.errors?.['minlength']">Name must be at least 3 characters</span>
                                    <span *ngIf="addonForm.get('name')?.errors?.['maxlength']">Name cannot exceed 50 characters</span>
                                </div>
                            </div>

                            <div class="addon-form-group">
                                <label class="addon-form-label">Description</label>
                                <textarea 
                                    formControlName="description"
                                    class="addon-form-textarea"
                                    placeholder="Enter add-on description"
                                    rows="4"
                                ></textarea>
                                <div *ngIf="addonForm.get('description')?.invalid && addonForm.get('description')?.touched" class="addon-error-message">
                                    <span *ngIf="addonForm.get('description')?.errors?.['maxlength']">Description cannot exceed 500 characters</span>
                                </div>
                                <div class="addon-char-counter" [class.addon-char-limit]="(addonForm.get('description')?.value?.length || 0) > 450">
                                    {{ addonForm.get('description')?.value?.length || 0 }}/500
                                </div>
                            </div>

                            <div class="addon-form-group">
                                <label class="addon-form-label">Spice Level</label>
                                <select 
                                    formControlName="spiceLevel"
                                    class="addon-form-select">
                                    <option *ngFor="let option of spiceLevelOptions" [value]="option.value">{{option.label}}</option>
                                </select>
                            </div>

                            <div class="addon-form-columns">
                                <div class="addon-form-left">
                                    <div class="addon-form-group">
                                        <label class="addon-form-label">Suggested Add-on</label>
                                        <div class="addon-toggle-container">
                                            <label class="addon-toggle">
                                                <input type="checkbox" formControlName="suggested">
                                                <span class="addon-toggle-slider"></span>
                                            </label>
                                            <span class="addon-toggle-label">{{ addonForm.get('suggested')?.value ? 'Suggested' : 'Not Suggested' }}</span>
                                        </div>
                                    </div>
                                </div>
                            
                                <div class="addon-form-right">
                                    <div class="addon-form-group">
                                        <label class="addon-form-label">Vegetarian</label>
                                        <div class="addon-toggle-container">
                                            <label class="addon-toggle">
                                                <input type="checkbox" formControlName="vegetarian">
                                                <span class="addon-toggle-slider"></span>
                                            </label>
                                            <span class="addon-toggle-label">{{ addonForm.get('vegetarian')?.value ? 'Vegetarian' : 'Non-Vegetarian' }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="addon-form-group">
                                <label class="addon-form-label">Allergens</label>
                                <div class="addon-allergens-container">
                                    <div *ngFor="let allergen of commonAllergens" class="addon-allergen-checkbox">
                                        <input 
                                            type="checkbox" 
                                            [id]="'allergen-' + allergen.id"
                                            [checked]="addonForm.get('allergens')?.value?.includes(allergen.id)"
                                            (change)="toggleAllergen(allergen.id)">
                                        <label [for]="'allergen-' + allergen.id">{{allergen.name}}</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="addon-form-right">
                            <div class="addon-form-group">
                                <label class="addon-form-label">Price ($) <span class="addon-required">*</span></label>
                                <input 
                                    type="number" 
                                    step="0.01"
                                    min="0"
                                    formControlName="price"
                                    class="addon-form-input"
                                    [class.addon-input-error]="addonForm.get('price')?.invalid && addonForm.get('price')?.touched"
                                    placeholder="0.00"
                                />
                                <div *ngIf="addonForm.get('price')?.invalid && addonForm.get('price')?.touched" class="addon-error-message">
                                    <span *ngIf="addonForm.get('price')?.errors?.['required']">Price is required</span>
                                    <span *ngIf="addonForm.get('price')?.errors?.['min']">Price cannot be negative</span>
                                </div>
                            </div>
                            
                            <div class="addon-form-group">
                                <label class="addon-form-label">Calories <span class="addon-required">*</span></label>
                                <input 
                                    type="number" 
                                    step="0.1"
                                    min="0"
                                    formControlName="calories"
                                    class="addon-form-input"
                                    [class.addon-input-error]="addonForm.get('calories')?.invalid && addonForm.get('calories')?.touched"
                                    placeholder="0.0"
                                />
                                <div *ngIf="addonForm.get('calories')?.invalid && addonForm.get('calories')?.touched" class="addon-error-message">
                                    <span *ngIf="addonForm.get('calories')?.errors?.['required']">Calories value is required</span>
                                    <span *ngIf="addonForm.get('calories')?.errors?.['min']">Calories cannot be negative</span>
                                </div>
                            </div>

                            <div class="addon-form-group">
                                <label class="addon-form-label">Status <span class="addon-required">*</span></label>
                                <div class="addon-toggle-container">
                                    <label class="addon-toggle">
                                        <input type="checkbox" formControlName="active">
                                        <span class="addon-toggle-slider"></span>
                                    </label>
                                    <span class="addon-toggle-label">{{ addonForm.get('active')?.value ? 'Active' : 'Inactive' }}</span>
                                </div>
                            </div>

                            <div class="addon-image-upload">
                                <label class="addon-form-label">Add-on Image</label>
                                
                                <div class="addon-image-preview-container">
                                    <div class="addon-image-preview" [class.addon-has-image]="imagePreview || (editingAddon && editingAddon.imagePath)">
                                        <img 
                                            *ngIf="imagePreview" 
                                            [src]="imagePreview" 
                                            alt="Image preview" 
                                            class="addon-preview-img"
                                        />
                                        <img 
                                            *ngIf="!imagePreview && editingAddon && editingAddon.imagePath" 
                                            [src]="getImagePath(editingAddon)" 
                                            alt="Current image" 
                                            class="addon-preview-img"
                                            (error)="handlePreviewError($event)"
                                        />
                                        <div *ngIf="!imagePreview && (!editingAddon || !editingAddon.imagePath)" class="addon-no-image">
                                            <i class="fas fa-image"></i>
                                            <span>No image selected</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="addon-image-tabs">
                                    <button 
                                        type="button"
                                        class="addon-image-tab" 
                                        [class.addon-tab-active]="imageInputType === 'file'"
                                        (click)="setImageInputType('file')">
                                        Upload Image
                                    </button>
                                    <button 
                                        type="button"
                                        class="addon-image-tab" 
                                        [class.addon-tab-active]="imageInputType === 'url'"
                                        (click)="setImageInputType('url')">
                                        Image URL
                                    </button>
                                </div>
                                
                                <div *ngIf="imageInputType === 'file'" class="addon-file-upload">
                                    <label class="addon-upload-btn">
                                        <input 
                                            type="file" 
                                            (change)="onImageSelect($event)"
                                            accept="image/*"
                                            hidden
                                        />
                                        <i class="fas fa-upload"></i>
                                        <span>{{ addonForm.get('image')?.value ? 'Change Image' : 'Select Image' }}</span>
                                    </label>
                                    <span *ngIf="addonForm.get('image')?.value" class="addon-filename">
                                        {{ getFileName() }}
                                    </span>
                                </div>
                                
                                <div *ngIf="imageInputType === 'url'" class="addon-url-input">
                                    <input 
                                        type="text" 
                                        class="addon-form-input"
                                        formControlName="imageUrl"
                                        placeholder="Enter image URL"
                                        (blur)="updateImagePreviewFromUrl()"
                                    />
                                    <button 
                                        type="button"
                                        class="addon-preview-url-btn"
                                        (click)="updateImagePreviewFromUrl()">
                                        Preview
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="addon-modal-divider"></div>
                    
                    <div class="addon-form-actions">
                        <button 
                            type="button" 
                            class="addon-btn-secondary"
                            (click)="closeDialog()">
                            Cancel
                        </button>
                        <button 
                            type="submit" 
                            class="addon-btn-primary"
                            [disabled]="addonForm.invalid || loading || formSubmitting">
                            <span *ngIf="!loading && !formSubmitting">{{ editingAddon ? 'Update Add-on' : 'Create Add-on' }}</span>
                            <span *ngIf="loading || formSubmitting" class="addon-btn-loader">
                                <i class="fas fa-spinner fa-spin"></i> Saving...
                            </span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- View Add-on Details Modal -->
    <div class="addon-modal-backdrop" *ngIf="showDetailsModal" (click)="closeDetailsModal($event)">
        <div class="addon-modal-container addon-details-modal" (click)="$event.stopPropagation()">
            <div class="addon-modal-header">
                <h2 class="addon-modal-title">Add-on Details</h2>
                <button class="addon-modal-close" (click)="closeDetailsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="addon-modal-divider"></div>
            
            <div class="addon-modal-body" *ngIf="selectedAddon">
                <div class="addon-details-content">
                    <div class="addon-details-image">
                        <img 
                            [src]="getImagePath(selectedAddon)" 
                            [alt]="selectedAddon.addOnName"
                            (error)="handleImageError($event)"
                        />
                    </div>
                    
                    <div class="addon-details-info">
                        <div class="addon-details-price">${{formatPrice(selectedAddon.addOnPrice)}}</div>
                        <h3 class="addon-details-name">{{ selectedAddon.addOnName }}</h3>
                        
                        <div class="addon-details-badges">
                            <span [class.addon-badge-active]="selectedAddon.active" [class.addon-badge-inactive]="!selectedAddon.active" class="addon-badge">
                                <i [class]="selectedAddon.active ? 'fas fa-check-circle' : 'fas fa-ban'"></i> 
                                {{ selectedAddon.active ? 'Active' : 'Inactive' }}
                            </span>
                            <span *ngIf="selectedAddon.suggested" class="addon-badge addon-badge-suggested">
                                <i class="fas fa-thumbs-up"></i> Suggested
                            </span>
                            <span *ngIf="selectedAddon.vegetarian" class="addon-badge addon-badge-vegetarian">
                                <i class="fas fa-leaf"></i> Vegetarian
                            </span>
                            <span *ngIf="selectedAddon.spiceLevel && selectedAddon.spiceLevel !== 'NONE'" class="addon-badge addon-badge-spicy">
                                <i class="fas fa-pepper-hot"></i> {{getSpiceLevelLabel(selectedAddon.spiceLevel)}}
                            </span>
                        </div>
                        
                        <div class="addon-details-section">
                            <h4 class="addon-details-section-title">Description</h4>
                            <p class="addon-details-description">{{ selectedAddon.description || 'No description provided' }}</p>
                        </div>
                        
                        <div class="addon-details-section">
                            <h4 class="addon-details-section-title">Nutrition & Dietary Info</h4>
                            <div class="addon-details-info-grid">
                                <div class="addon-details-info-item">
                                    <span class="addon-details-label">Calories:</span>
                                    <span class="addon-details-value">{{ selectedAddon.calories }}</span>
                                </div>
                                <div class="addon-details-info-item">
                                    <span class="addon-details-label">Vegetarian:</span>
                                    <span class="addon-details-value">{{ selectedAddon.vegetarian ? 'Yes' : 'No' }}</span>
                                </div>
                                <div class="addon-details-info-item">
                                    <span class="addon-details-label">Spice Level:</span>
                                    <span class="addon-details-value">{{ selectedAddon.spiceLevel ? getSpiceLevelLabel(selectedAddon.spiceLevel) : 'None' }}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="addon-details-section" *ngIf="selectedAddon.allergens && selectedAddon.allergens.length > 0">
                            <h4 class="addon-details-section-title">Allergens</h4>
                            <div class="addon-details-allergens">
                                <span class="addon-allergen-tag" *ngFor="let allergenName of getAllergenNames(selectedAddon)">
                                    {{allergenName}}
                                </span>
                            </div>
                        </div>
                        
                        <div class="addon-details-section" *ngIf="selectedAddon.categories && selectedAddon.categories.length > 0">
                            <h4 class="addon-details-section-title">Available in Categories</h4>
                            <div class="addon-details-categories">
                                <div class="addon-category-chip" *ngFor="let category of selectedAddon.categories">
                                    {{category.name}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="addon-modal-divider"></div>
            
            <div class="addon-details-actions">
                <button 
                    *ngIf="editAddon"
                    class="addon-btn-secondary"
                    (click)="editFromDetails()">
                    <i class="fas fa-edit"></i> Edit Add-on
                </button>
                <button 
                    class="addon-btn-primary"
                    (click)="closeDetailsModal()">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div class="addon-modal-backdrop" *ngIf="showDeleteConfirmation" (click)="cancelDelete($event)">
        <div class="addon-modal-container addon-delete-modal" (click)="$event.stopPropagation()">
            <div class="addon-modal-header">
                <h2 class="addon-modal-title addon-delete-title">Confirm Deletion</h2>
                <button class="addon-modal-close" (click)="cancelDelete()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="addon-modal-divider"></div>
            
            <div class="addon-modal-body">
                <div class="addon-delete-icon">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                
                <h3 class="addon-delete-heading">Are you sure you want to delete this add-on?</h3>
                
                <p class="addon-delete-message">
                    You are about to delete "<strong>{{ addonToDelete?.addOnName }}</strong>". 
                    This action cannot be undone and this add-on will be removed from all menu items that use it.
                </p>
                
                <div class="addon-delete-item">
                    <div class="addon-delete-preview">
                        <img 
                            *ngIf="addonToDelete?.imagePath" 
                            [src]="getImagePath(addonToDelete!)" 
                            [alt]="addonToDelete?.addOnName"
                            (error)="handleImageError($event)"
                        />
                        <div *ngIf="!addonToDelete?.imagePath" class="addon-no-preview">
                            <i class="fas fa-image"></i>
                        </div>
                    </div>
                    
                    <div class="addon-delete-details">
                        <h4 class="addon-delete-name">{{ addonToDelete?.addOnName }}</h4>
                        <p class="addon-delete-description">{{ addonToDelete?.description || 'No description' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="addon-modal-divider"></div>
            
            <div class="addon-delete-actions">
                <button 
                    class="addon-btn-secondary"
                    (click)="cancelDelete()">
                    Cancel
                </button>
                <button 
                    class="addon-btn-danger"
                    [disabled]="deletingAddon"
                    (click)="proceedWithDelete()">
                    <span *ngIf="!deletingAddon">
                        <i class="fas fa-trash"></i> Delete Permanently
                    </span>
                    <span *ngIf="deletingAddon" class="addon-btn-loader">
                        <i class="fas fa-spinner fa-spin"></i> Deleting...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div *ngIf="toast" class="addon-toast" [class.addon-toast-success]="toast.type === 'success'" [class.addon-toast-error]="toast.type === 'error'">
        <div class="addon-toast-icon">
            <i *ngIf="toast.type === 'success'" class="fas fa-check-circle"></i>
            <i *ngIf="toast.type === 'error'" class="fas fa-exclamation-circle"></i>
        </div>
        <div class="addon-toast-content">
            <p class="addon-toast-message">{{ toast.message }}</p>
        </div>
        <button class="addon-toast-close" (click)="dismissToast()">
            <i class="fas fa-times"></i>
        </button>
        <div class="addon-toast-progress"></div>
    </div>
</div>
